{% extends "base.html" %}
{% block title %}Edit Note{% endblock %}
{% block content %}
<h2>Edit Note</h2>
<form method="POST" id="edit-note-form" enctype="multipart/form-data">
<div class="form-group">
<label>Title</label>
<input type="text" name="title" class="form-control"
value="{{ note.title }}">
</div>
<div class="form-group">
<label>Content</label>
<div id="editor-container" style="height:200px; background: white;"></div>
<input type="hidden" name="note" id="note_content_hidden">
</div>
<div class="form-group">
<label>Tags (comma separated) </label>
<input type="text" name="tags" class="form-control" value="{{ note.tags
| join(', ') }}">
</div>
<div class="form-check">
<input type="checkbox" name="is_public" class="form-check-input"
id="publicCheck" {% if note.is_public %} checked {% endif %}>
<label class="form-check-label" for="publicCheck">Public</label>
</div>
<div class="form-check">
<input type="checkbox" name="pinned" class="form-check-input"
id="pinnedCheck" {% if note.pinned %} checked {% endif %}>
<label class="form-check-label" for="pinnedCheck">Pin this note</label>
</div>
<div class="form-group mt-2">
  <label>Attachment (image/pdf/doc)</label>
  <input type="file" name="attachment" class="form-control-file">
  {% if note.attachments %}
    <small class="d-block text-muted">Existing files:</small>
    <ul>
      {% for att in note.attachments %}
        <li>{{ att.filename }}</li>
      {% endfor %}
    </ul>
  {% endif %}
</div>
<button type="submit" class="btn btn-success mt-3">Update Note</button>
</form>
{% endblock %}
{% block scripts %}
<script>
var quill = new Quill('#editor-container', {
    theme: 'snow',
    modules: { toolbar: [['bold', 'italic'], ['list', 'bullet']] }
});

// Load existing content into the editor [cite: 327]
quill.root.innerHTML = '{{ note.content | safe }}';

// The global script in index.js handles form submission sync via note_content_hidden ID.
</script>
{% endblock %}
